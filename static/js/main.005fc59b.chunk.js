(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{135:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var s=n(0),i=n.n(s),a=n(23),r=n(59),o=n(106),c=n(34),l=n(111),u=(n(129),n(9)),h=n(65),p="0XXQyxbiCjVU7jN2URXuhg",d="yATlKFDZwdLtjHzyTeCK",b="UPDATE_TEXTINPUT",g="RECEIVE_GEOCODE_RESULTS",j="REQUEST_GEOCODE_RESULTS",m="UPDATE_CENTER",f="UPDATE_SETTINGS",v="RECEIVE_ISOCHRONES_RESULTS",O="REQUEST_ISOCHRONES_RESULTS",x=function(e){return function(t){var n=function(e){return e.response&&e.response.isoline.length>0?e.response.isoline.reverse():[]}(e);t(y(n))}},y=function(e){return{type:v,results:e}},C=function(e){var t={};t.mode="fastest;".concat(e.mode,";traffic:").concat(e.traffic,";"),t.rangetype=e.rangetype,t.start=e.isochronesCenter.lat+","+e.isochronesCenter.lng;var n=[];if("time"===e.rangetype){for(var s=60*e.range.value,i=60*e.interval.value;s>0;)n.push(s),s-=i;t.range=n.join(",")}else if("distance"===e.rangetype){for(var a=1e3*e.range.value,r=1e3*e.interval.value;a>0;)n.push(a),a-=r;t.range=n.join(",")}return t},_=function(){return{type:O}},R=function(e){return function(t){var n=function(e,t){if(e.Response&&e.Response.View.length>0){var n,s=[],i=Object(h.a)(e.Response.View[0].Result);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.Location&&"point"===a.Location.LocationType&&s.push({title:a.Location.Address.Label,description:a.Location.Address.PostalCode,displayposition:{lat:a.Location.DisplayPosition.Latitude,lng:a.Location.DisplayPosition.Longitude}})}}catch(r){i.e(r)}finally{i.f()}return s}}(e);t(T(n))}},T=function(e){return{type:g,results:e}},E=function(e){return Object(u.a)({type:j},e)},S=function(e){return{type:b,payload:e}},I={userInput:"",geocodeResults:[],isochrones:{results:[]},isFetching:!1,isFetchingIsochrones:!1,settings:{isochronesCenter:{},range:{max:500,value:60},interval:{max:60,value:10},mode:"car",rangetype:"distance",traffic:"disabled"}},L=Object(r.combineReducers)({isochronesControls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(u.a)(Object(u.a)({},e),{},{userInput:t.payload.inputValue});case j:return Object(u.a)(Object(u.a)({},e),{},{isFetching:!0});case g:return Object(u.a)(Object(u.a)({},e),{},{geocodeResults:t.results,isFetching:!1});case O:return Object(u.a)(Object(u.a)({},e),{},{isFetchingIsochrones:!0});case v:return Object(u.a)(Object(u.a)({},e),{},{isFetchingIsochrones:!1,isochrones:{results:t.results}});case f:return Object(u.a)(Object(u.a)({},e),{},{settings:t.settings});case m:return Object(u.a)(Object(u.a)({},e),{},{settings:Object(u.a)(Object(u.a)({},e.settings),{},{isochronesCenter:t.isochronesCenter})});default:return e}}}),w=L,k=n(29),B=n(30),U=n(38),z=n(36),N=n(12),A=n.n(N),F=n(108),P=n.n(F),D={};D.HERE=N.TileLayer.extend({options:{subdomains:"1234",minZoom:2,maxZoom:18,scheme:"normal.day",resource:"maptile",mapId:"newest",format:"png8",appId:"",appCode:""},initialize:function(e){var t=(e=N.setOptions(this,e)).scheme.split(".")[0];e.tileResolution=256,N.Browser.retina&&(e.tileResolution=512);var n="base.maps.api.here.com";"satellite"!=t&&"terrain"!=t&&"hybrid"!=t||(n="aerial.maps.api.here.com"),-1!==e.scheme.indexOf(".traffic.")&&(n="traffic.maps.api.here.com");var s="https://{s}."+n+"/{resource}/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}?app_id={appId}&app_code={appCode}";this._attributionUrl=N.Util.template("https://1."+n+"/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}",this.options),N.TileLayer.prototype.initialize.call(this,s,e),this._attributionText=""},onAdd:function(e){N.TileLayer.prototype.onAdd.call(this,e),this._attributionBBoxes||this._fetchAttributionBBoxes()},onRemove:function(e){N.TileLayer.prototype.onRemove.call(this,e),this._map.attributionControl.removeAttribution(this._attributionText),this._map.off("moveend zoomend resetview",this._findCopyrightBBox,this)},_fetchAttributionBBoxes:function(){var e=new XMLHttpRequest;e.onreadystatechange=N.bind((function(){4==e.readyState&&200==e.status&&this._parseAttributionBBoxes(JSON.parse(e.responseText))}),this),e.open("GET",this._attributionUrl,!0),e.send()},_parseAttributionBBoxes:function(e){if(this._map){for(var t=e[this.options.scheme.split(".")[0]]||e.normal,n=0;n<t.length;n++)if(t[n].boxes)for(var s=0;s<t[n].boxes.length;s++){var i=t[n].boxes[s];t[n].boxes[s]=N.latLngBounds([[i[0],i[1]],[i[2],i[3]]])}this._map.on("moveend zoomend resetview",this._findCopyrightBBox,this),this._attributionProviders=t,this._findCopyrightBBox()}},_findCopyrightBBox:function(){if(this._map){for(var e=this._attributionProviders,t=[],n=this._map.getZoom(),s=this._map.getBounds(),i=0;i<e.length;i++){if(e[i].minLevel<n&&e[i].maxLevel>n&&!e[i].boxes){t.push(e[i]);break}for(var a=0;a<e[i].boxes.length;a++){var r=e[i].boxes[a];if(s.overlaps(r)){t.push(e[i]);break}}}var o=['<a href="https://legal.here.com/terms/serviceterms/gb/">HERE maps</a>'];for(i=0;i<t.length;i++){var c=t[i];o.push('<abbr title="'+c.alt+'">'+c.label+"</abbr>")}var l="\xa9 "+o.join(", ")+". ";l!==this._attributionText&&(this._map.attributionControl.removeAttribution(this._attributionText),this._map.attributionControl.addAttribution(this._attributionText=l))}}}),D.here=function(e){return new D.HERE(e)};var G=D,H=n(2),V={width:"100%",height:"100vh"},M=G.here({appId:"yATlKFDZwdLtjHzyTeCK",appCode:"0XXQyxbiCjVU7jN2URXuhg",scheme:"reduced.day"}),X=A.a.featureGroup(),Z=A.a.featureGroup(),K=A.a.latLng(-90,-180),Q=A.a.latLng(90,180),J={center:[25.95681,-35.729687],zoomControl:!1,maxBounds:A.a.latLngBounds(K,Q),zoom:2,layers:[X,Z,M]},q=function(e){Object(U.a)(n,e);var t=Object(z.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"addIsochrones",value:function(){Z.clearLayers();var e=this.props.isochronesControls.isochrones.results;if(e.length>0){var t,n=0,s=P.a.scale(["#f44242","#f4be41","#41f497"]).mode("hsl").colors(e.length),i=Object(h.a)(e);try{for(i.s();!(t=i.n()).done;){var a,r=t.value,o=Object(h.a)(r.component);try{for(o.s();!(a=o.n()).done;){var c=a.value;A.a.polygon(c.shape.map((function(e){return e.split(",")})),{fillColor:s[n],weight:2,opacity:1,color:"white",pane:"isochronesPane"}).addTo(Z)}}catch(l){o.e(l)}finally{o.f()}n+=1}}catch(l){i.e(l)}finally{i.f()}this.map.fitBounds(Z.getBounds())}}},{key:"addIsochronesCenter",value:function(){X.clearLayers();var e=this.props.isochronesControls.settings.isochronesCenter;e.lat&&e.lng&&(A.a.circleMarker(e).addTo(X).bindTooltip("latitude: "+e.lat+", longitude: "+e.lng,{permanent:!1}).openTooltip(),this.map.setView(e,7))}},{key:"componentDidUpdate",value:function(){this.addIsochronesCenter(),this.addIsochrones()}},{key:"componentDidMount",value:function(){this.map=A.a.map("map",J),this.map.createPane("isochronesPane").style.opacity=.9;var e={"HERE reduced.day":M};A.a.control.layers(e).addTo(this.map),A.a.control.zoom({position:"topright"}).addTo(this.map);var t=A.a.control({position:"bottomright"});t.onAdd=function(e){var t=A.a.DomUtil.create("div","brand");return t.innerHTML='<a href="https://gis.ops.com" target="_blank"><img src="http://104.199.51.11:8083/wp-content/uploads/2018/11/gisops.png" width="150px"></img></a>',t},this.map.addControl(t)}},{key:"render",value:function(){return Object(H.jsx)("div",{id:"map",style:V})}}]),n}(i.a.Component),W=Object(c.b)((function(e){return{isochronesControls:e.isochronesControls}}))(q),Y=n(70),$=n(155),ee=n(151),te=n(152),ne=n(153),se=n(97),ie=n(112),ae=function(e){Object(U.a)(n,e);var t=Object(z.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"updateSettings",value:function(){var e,t=this.props,n=t.controls;(0,t.dispatch)((e={settings:n.settings},Object(u.a)({type:f},e)))}},{key:"handleSettings",value:function(e,t){this.props.controls.settings[e]=t,this.updateSettings()}},{key:"alignRangeInterval",value:function(){var e=this.props.controls;(e.settings.range.value<e.settings.interval.value||""===e.settings.interval.value)&&(e.settings.interval.value=e.settings.range.value),e.settings.interval.max=e.settings.range.value}},{key:"render",value:function(){var e=this,t=this.props.controls,n="time"===t.settings.rangetype?" minutes":" kilometers",s={settings:Object(u.a)(Object(u.a)({},t.settings.range),{},{min:1,step:1,start:t.settings.range.value,onChange:function(n){t.settings.range.value=n,e.alignRangeInterval(),e.updateSettings()}})},i={settings:Object(u.a)(Object(u.a)({},t.settings.interval),{},{min:1,step:1,start:t.settings.interval.value,onChange:function(n){t.settings.interval.value=n,e.updateSettings()}})};return Object(H.jsxs)("div",{className:"mt3",children:[Object(H.jsx)(ee.a,{}),Object(H.jsx)(ie.a,{size:"small",children:"Mode of transport"}),Object(H.jsxs)("div",{className:"mt3",children:[Object(H.jsx)(ne.a.Group,{basic:!0,size:"small",children:Object.keys({pedestrian:{},car:{}}).map((function(n,s){return Object(H.jsx)(ne.a,{active:n===t.settings.mode,mode:n,onClick:function(){return e.handleSettings("mode",n)},children:n},s)}))}),"car"===t.settings.mode&&Object(H.jsxs)("div",{children:[Object(H.jsx)(ee.a,{}),Object(H.jsx)(ie.a,{size:"small",children:"Traffic"}),Object(H.jsx)("div",{className:"mt3",children:Object(H.jsx)(ne.a.Group,{basic:!0,size:"small",children:Object.keys({enabled:{},disabled:{}}).map((function(n,s){return Object(H.jsx)(ne.a,{active:n===t.settings.traffic,mode:n,onClick:function(){return e.handleSettings("traffic",n)},children:n},s)}))})})]})]}),Object(H.jsx)(ee.a,{}),Object(H.jsx)(ie.a,{size:"small",children:"Range type"}),Object(H.jsx)("div",{className:"mt3",children:Object(H.jsx)(ne.a.Group,{basic:!0,size:"small",children:Object.keys({distance:{},time:{}}).map((function(n,s){return Object(H.jsx)(ne.a,{active:n===t.settings.rangetype,mode:n,onClick:function(){return e.handleSettings("rangetype",n)},children:n},s)}))})}),Object(H.jsx)(ee.a,{}),Object(H.jsx)(ie.a,{size:"small",children:"Maximum range"}),Object(H.jsxs)("div",{className:"mt3",children:[Object(H.jsx)(se.Slider,{discrete:!0,color:"grey",value:t.settings.range.value,inverted:!1,settings:s.settings}),Object(H.jsx)("div",{className:"mt2",children:Object(H.jsx)(ie.a,{className:"mt2",color:"grey",size:"mini",children:t.settings.range.value+n})})]}),Object(H.jsx)(ee.a,{}),Object(H.jsx)(ie.a,{size:"small",children:"Interval step"}),Object(H.jsxs)("div",{className:"mt3",children:[Object(H.jsx)(se.Slider,{discrete:!0,color:"grey",value:t.settings.interval.value,inverted:!1,settings:i.settings}),Object(H.jsx)("div",{className:"mt2",children:Object(H.jsx)(ie.a,{className:"mt2",color:"grey",size:"mini",children:t.settings.interval.value+n})})]})]})}}]),n}(i.a.Component),re=Object(c.b)((function(e){return{controls:e.isochronesControls}}))(ae),oe=n(110),ce={zIndex:999,position:"absolute",width:"400px",top:"10px",left:"10px",maxHeight:"calc(100vh - 5vw)",overflow:"auto",padding:"20px"},le=function(e){Object(U.a)(n,e);var t=Object(z.a)(n);function n(e){var s;return Object(k.a)(this,n),(s=t.call(this,e)).handleSearchChange=function(e){(0,s.props.dispatch)(S({inputValue:e.target.value})),s.fetchGeocodeResults()},s.handleResultSelect=function(e,t){var n,i=t.result,a=s.props.dispatch;a(S({inputValue:i.title})),a((n={isochronesCenter:i.displayposition},Object(u.a)({type:m},n)))},s.handleFetchIsochrones=function(){var e,t=s.props,n=t.dispatch,i=t.settings;i.isochronesCenter.lat&&i.isochronesCenter.lng&&n((e={settings:i},function(t){t(_());var n=C(e.settings),s=new URL("https://isoline.route.api.here.com/routing/7.2/calculateisoline.json"),i=Object(u.a)({app_id:d,app_code:p},n);return s.search=new URLSearchParams(i),fetch(s).then((function(e){return e.json()})).then((function(e){return t(x(e))})).catch((function(e){return console.error(e)}))}))},s.handleSearchChange=s.handleSearchChange.bind(Object(Y.a)(s)),s.fetchGeocodeResults=Object(oe.a)(1e3,s.fetchGeocodeResults),s}return Object(B.a)(n,[{key:"fetchGeocodeResults",value:function(){var e,t=this.props,n=t.dispatch,s=t.userTextInput;s.length>0&&n((e={inputValue:s},function(t){t(E());var n=new URL("https://geocoder.api.here.com/6.2/geocode.json"),s={app_id:d,app_code:p,searchtext:e.inputValue};return n.search=new URLSearchParams(s),fetch(n).then((function(e){return e.json()})).then((function(e){return t(R(e))})).catch((function(e){return console.error(e)}))}))}},{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.userTextInput,s=e.results,i=e.settings,a=e.isFetchingIsochrones;return Object(H.jsx)("div",{children:Object(H.jsxs)($.a,{style:ce,children:[Object(H.jsx)("div",{children:Object(H.jsxs)("span",{children:["Isochrones powered by ",Object(H.jsx)("strong",{children:"HERE Maps"})]})}),Object(H.jsx)(ee.a,{}),Object(H.jsxs)("div",{className:"flex justify-between items-center mt3",children:[Object(H.jsx)(te.a,{onSearchChange:this.handleSearchChange,onResultSelect:this.handleResultSelect,type:"text",fluid:!0,input:{fluid:!0},loading:t,className:"flex-grow-1 mr2",results:s,value:n,placeholder:"Find Address ..."}),Object(H.jsx)(ne.a,{circular:!0,loading:a,disabled:!i.isochronesCenter.lat||!i.isochronesCenter.lng,color:"purple",icon:"globe",onClick:this.handleFetchIsochrones})]}),Object(H.jsx)("div",{className:"mt2",children:Object(H.jsx)(re,{})})]})})}}]),n}(i.a.Component),ue=Object(c.b)((function(e){return{userTextInput:e.isochronesControls.userInput,results:e.isochronesControls.geocodeResults,isFetching:e.isochronesControls.isFetching,settings:e.isochronesControls.settings,isFetchingIsochrones:e.isochronesControls.isFetchingIsochrones}}))(le),he=function(e){Object(U.a)(n,e);var t=Object(z.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"render",value:function(){return Object(H.jsxs)("div",{children:[Object(H.jsx)(W,{}),Object(H.jsx)(ue,{})]})}}]),n}(i.a.Component),pe=he,de=(n(135),[l.a]),be=Object(r.createStore)(w,Object(o.composeWithDevTools)(r.applyMiddleware.apply(void 0,de)));Object(a.render)(Object(H.jsxs)(c.a,{store:be,children:[" ",Object(H.jsx)(pe,{})]}),document.getElementById("root"))}},[[136,1,2]]]);
//# sourceMappingURL=main.005fc59b.chunk.js.map